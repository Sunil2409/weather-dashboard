<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weather Dashboard</title>
    <link
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
        rel="stylesheet"
    >
</head>

<body class="bg-light">
    <div class="container py-5">
        <h1 class="text-center mb-4">Real-Time Weather Dashboard</h1>

        <!-- FORM HERE -->
        <form method="POST" class="w-50 mx-auto">
            {% csrf_token %}
            <input
                type="text"
                name="city"
                class="form-control mb-3"
                placeholder="Enter city name"
                required
            >
            <button class="btn btn-primary w-100">Check Weather</button>
        </form>

        <!-- WEATHER DATA BLOCK HERE -->
        {% if data %}
            {% if data.error %}
                <div class="alert alert-danger mt-4 text-center">
                    {{ data.error }}
                </div>
            {% else %}
                <div class="card mt-4 w-50 mx-auto">
                    <div class="card-body">
                        <h3 class="card-title text-center">{{ city|title }}</h3>

                        <p><strong>Temperature:</strong> {{ data.main.temp }} °C</p>
                        <p><strong>Weather:</strong> {{ data.weather.0.description|title }}</p>
                        <p><strong>Humidity:</strong> {{ data.main.humidity }}%</p>
                        <p><strong>Wind Speed:</strong> {{ data.wind.speed }} m/s</p>
                    </div>
                </div>
            {% endif %}
        {% endif %}

        <!-- ⭐ ADD THE AQI BLOCK RIGHT BELOW THIS ⭐ -->
        {% if aqi %}
            {% if aqi.error %}
                <div class="alert alert-warning mt-4 text-center">
                    {{ aqi.error }}
                </div>
            {% else %}
                <div class="card mt-4 w-50 mx-auto border-success">
                    <div class="card-body">

                        <h4 class="text-center">Air Quality Index (AQI)</h4>

                        {% with aqi_value=aqi.list.0.main.aqi %}
                            <p><strong>Overall AQI:</strong>
                                <span class="badge bg-primary">{{ aqi_value }}</span>
                            </p>

                            <p><strong>PM2.5:</strong> {{ aqi.list.0.components.pm2_5 }} μg/m³</p>
                            <p><strong>PM10:</strong> {{ aqi.list.0.components.pm10 }} μg/m³</p>
                            <p><strong>NO₂:</strong> {{ aqi.list.0.components.no2 }} μg/m³</p>
                            <p><strong>SO₂:</strong> {{ aqi.list.0.components.so2 }} μg/m³</p>
                            <p><strong>CO:</strong> {{ aqi.list.0.components.co }} μg/m³</p>
                            <p><strong>O₃:</strong> {{ aqi.list.0.components.o3 }} μg/m³</p>
                        {% endwith %}

                    </div>
                </div>
            {% endif %}
        {% endif %}
        <!-- ⭐ END OF AQI BLOCK ⭐ -->

    </div>
</body>
</html>
